#ディレクトリ、ファイル設定
mkdir ~/.ssh
touch ~/.ssh/config
chmod 700 ~/.ssh
chmod 600 ~/.ssh/*
xattr -cr ~/.ssh

＃初期設定
git config --global user.name "test"
git config --global user.email test@example.com
git config --global color.ui auto
git config --global color.diff auto
git config --global color.status auto
git config --global color.branch auto
#ファイル名の大文字・小文字の変更を検知する。
git config --global core.ignorecase false
#日本語ファイル名をエスケープせずに表示
git config --global core.quotepath false
#濁点つきのディレクトリ・ファイルが分けて表示されてしまう UTF8-MAC 問題の解決方法
git config --global core.precomposeunicode true
#マージコンフリクトを見やすくする
git config --global merge.conflictStyle diff3

#ローカルの設定
git config -l
#グローバルの設定
git config --global -l

#ssh-agentを起動
eval "$(ssh-agent -s)"
#秘密鍵の登録状況を確認
ssh-add -l
※登録なし表示
The agent has no identities.
※起動前表示
Could not open a connection to your authentication agent.

#SSHキーの確認
ls -al ~/.ssh
#新しいSSHキーを生成する
ssh-keygen -t rsa -b 4096 -C "test@example.com"
ssh-keygen -t ed25519 -N "" -f ~/.ssh/github -C test@example.com
-t : 鍵の種類を選択。安全面と性能面で最強なEd25519アルゴリズム一択です。
-C : GitHubに設定したメールアドレスを指定するのが一般的なようです。
-f : ファイル名を指定。デフォルトは ~/.ssh/id_ed25519
-N : パスフレーズの指定。 "" でパスフレーズなし
セキュリティを上げるなら設定する

#SSH秘密鍵をssh-agentに追加し、パスフレーズをキーチェーンに保存
ssh-add -K ~/.ssh/id_rsa
ssh-add -K ~/.ssh/github

#SSHキーをクリップボードにコピー
pbcopy < ~/.ssh/id_rsa.pub
pbcopy < ~/.ssh/github.pub
#接続テスト
ssh -T github
正常メッセージ
Hi syunhigu! You've successfully authenticated, but GitHub does not provide shell access.
※下記警告メッセージが出た場合は後述のコマンド実施
Warning: Permanently added 'github.com,13.114.40.48' (RSA) to the list of known hosts.
ssh-Keygen -R github.com,52.69.186.44

※下記警告メッセージが出た場合は後述のコマンド実施
WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!
※/Users/syunhigu/.ssh/known_hostsに同じ名前で存在しているため
→ipアドレスは上記ファイルから確認する
☆コマンド実施時は上記ファイルは閉じておくこと
ssh-keygen -R 52.192.72.89

------------------------------------
#gitクローン
#クローンしたいフォルダに移動
cd フォルダ
git clone https://github.com/syunhigu/develop-dev.git
#ローカルのブランチからブランチを作成する方法
#ブランチ一覧表示
git branch -a
#ローカルブランチの一覧を表示
git branch
#リモートブランチの一覧を表示
git branch --remote
#ローカルの追跡ブランチの情報を更新（リモートブランチの情報と同期）
git remote update -p
#ブランチを作る元のブランチに切り替える
git checkout master
#ブランチを作成
git checkout -b 作成するブランチ名
#ブランチをリモートに登録
git push -u origin 作成したブランチ名

#リモートブランチから作る方法
#リモートブランチからローカルブランチを作成
git checkout -b ローカルに作成するブランチ名 origin/作成元のリモートのブランチ名
#ブランチ一覧表示
git branch -a
#ブランチをリモートに登録
git push -u origin 作成したブランチ

#リモートリポジトリに登録する方法
※あらかじめリモートリポジトリを作成してある場合
#対象フォルダ配下でローカルリポジトリ作成
git init
git branch -m master
#push対象ファイルをインデックスに追加
git add xxx
#コミット
git commit -m "xxx"
#リモートリポジトリに追加
git remote add origin https://github.com/ユーザーID/リモートリポジトリ名.git
git remote add origin git@github.com:ユーザーID/リモートリポジトリ名.git
#リモートリポジトリにpush
git push -u origin master

------------------------------------
#コミット
#変更したファイルの一覧を確認
git status
※メッセージ内容
・modified:修正したファイル
・deleted:削除したファイル
・Untracked files:新規作成したファイル
#変更したファイルのソースコードを確認
git diff
#変更点に問題なければコミット
#コミットしたいファイルを選択
git add xxx
※例
git add app/scripts/controllers/kakugenctrl.js
#消す対象のファイルをコミット対象とする時
git rm app/scripts/controllers/detail.jsbk
#git管理下にある複数のファイルをrmしたときに、それらを一括してgit rmしたい場合
git rm `git ls-files --deleted`
#ディレクトリ単位でコミットしたい時は以下のようにディレクトリ指定も可能
git add ./
#コミット対象を確認する
git status
#コミットする
git commit
#-m オプションを使用するとコメントを同時にセットできる
git commit -m "格言画面へ飛ぶように修正"
#githubへpush
git push origin xxx

------------------------------------
#push前に直前のコミットをなかったことにする方法
#ローカルリポジトリ内で下記コマンドを実行して直前のコミットをなかったことにしてソースの状態も直前のコミットのをする前の状態に戻す。
git reset --hard HEAD^
#ローカルリポジトリ内で下記コマンドを実行して直前のコミットをなかったことにしてソースはそのままにする。
git reset --soft HEAD^

------------------------------------
#リバートしたいとき
#特定コミットの処理を、うち消すコミットを作成する
https://www.sejuku.net/blog/71634#index_id2
git revert <打ち消したいコミットID>

------------------------------------
#リバート取り消したいとき
https://mebee.info/2021/06/28/post-30245/
git revert --abort

------------------------------------
#マージしたい時
#masterブランチにマージするとき
#masterブランチに移動
git checkout master
# masterブランチにfeatureブランチをマージします
git merge feature/58
#コミットする　※必要に応じて
git commit -m "feature/58"
#githubへpush
git push origin xxx

------------------------------------
#マージしたけどやっぱりやめたい時のやり方
#その1 「マージしたらコンフリクトした。やっぱりやめよう。」
git merge --abort
#その2 「マージしたらコンフリクトした。コンフリクトを解消しようといろいろ編集した。でもやっぱりやめよう。」
git reset --hard HEAD
#その3 「マージすべて完了した。でもやっぱりやめよう。」パート1
git revert -m 1 <merge_commit>
マージコミットの場合、親が2つに分かれる。
revertコマンドを使う場合は、revertした結果どちらの親に戻すのかを-m 数字で指定する。数字が親を表す。
詳しくはこちらの記事参照
https://qiita.com/chihiro/items/2fa827d0eac98109e7ee
※この方法の場合、取り消したマージコミットに含まれていた変更を再度マージすることはできなくなる。
#その3 「マージすべて完了した。でもやっぱりやめよう。」パート2
git reset --hard ORIG_HEAD
マージが完了(コミットまで)したけれども、やっぱりマージ前に戻したい、というとき、パート2。
※この方法は一度できたコミットを取り消すことになる。
revertコマンドとは違い、「コミットを取り消した」という履歴も残らない。

------------------------------------
#ブランチ名変更
##ローカルブランチ名の変更
git branch -m 古いブランチ名 新しいブランチ名

// 今いるブランチの名前を変更する場合
git branch -m 新しいブランチ名
##リモートブランチ名の変更
手順としては、
1. ローカルのブランチ名を変更
2. 変更したブランチを新たにリモートへpush
3. 間違えてpushしたリモートブランチを削除
git branch -m 古いブランチ名 新しいブランチ名
git push -u origin 現在のブランチ名      // $ git push -u origin HEAD とするとブランチ名を入力しなてもpushできるので便利。
git push origin :リモートのブランチ名

------------------------------------
#ローカルブランチ削除
git branch --delete develop
#ローカルブランチ強制削除
git branch -D develop
#リモートブランチ削除
git push --delete origin develop

－－－－－－－－－－－－－－－－－－－－
# 目的
複数のGitHubアカウント（例えば「個人用」と「仕事用」）を切り替えてリポジトリを操作できるようにする。
## 手順概要
1. 各アカウント用にSSH鍵を作成
2. SSH設定ファイルを編集
3. Git設定（ユーザー名・メール）を切り替え
4. リポジトリごとに適用

## 手順
1. SSH鍵を作成
```
# 個人アカウント用
ssh-keygen -t ed25519 -C "your_personal_email@example.com" -f ~/.ssh/id_ed25519_personal

# 仕事アカウント用
ssh-keygen -t ed25519 -C "your_work_email@example.com" -f ~/.ssh/id_ed25519_work
```

2. GitHubに公開鍵を登録

3. SSH設定ファイル（~/.ssh/config）を編集
※ ファイルが存在しない場合は新規作成。改行・インデントに注意。
```
# 個人アカウント
Host github-personal
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_personal

# 仕事アカウント
Host github-work
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_work
```

4. Gitのユーザー設定
各リポジトリで使うユーザー名とメールアドレスを設定。
```
# リポジトリディレクトリで実行
git config user.name "Your Name"
git config user.email "your_email@example.com"
```

5. リポジトリのclone時にHostを指定
```
# 個人アカウントからクローン
git clone git@github-personal:username/repo.git

# 仕事アカウントからクローン
git clone git@github-work:username/repo.git
```

補足
・すでにclone済みのリポジトリの .git/config を編集して url を変更してもOK。
・GitHub CLI（gh）でのアカウント切り替えも可能だが、SSHの切り替えのほうが一般的で確実。
